<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>wenzi</title>
</head>
<body>

    <span style="font-family:Microsoft YaHei;font-size:12px;">
        <input type="text" maxlength="30" class="int_txt" name="album_name" id="album_name">
        <span class="count_txt"><span id="name_word">0</span>/30</span>
    </span>

    <button type="button" id="uploadExcel"><i>&nbsp;上传Excel</i></button>


</body>
</html>
<!-- <script src='../web/js/public/jquery.min.js'></script> -->
<script type="text/javascript" src='jquery-1.8.3.min.js'></script>
<script type="text/javascript" src='ocupload.js'></script>
<script type="text/javascript" charset="utf-8" async defer>
   var text = $("#album_name").val();
    var counter = text.length;
   $("#numtj var").text(counter);
   $(document).keyup(function() {
          var text = $("#album_name").val();
          var counter = text.length;
         $("#name_word").text(counter);
   });

    //调用OCUpload插件的方法
    $("#uploadExcel").upload({
        action:"a.php", //表单提交的地址
        name:"myFile",
        enctype: 'multipart/form-data',//mime类型，默认即可
        onComplete:function (data) { //提交表单之后
            console.log(data);
            if(data == "0"){
                alert('success') //提示框，Excel导入成功
            }else{
               alert('fail') //提示框，Excel导入成失败
            }
        },
        onSelect: function() {//当用户选择了一个文件后触发事件
            //当选择了文件后，关闭自动提交
            this.autoSubmit=false;
            debugger;
            //校验上传的文件名是否满足后缀为.xls或.xlsx
            var regex =/^.*\.(?:xls|xlsx)$/i;
            //this.filename()返回当前选择的文件名称 (ps：我使用这个方法没好使，自己写了一个获取文件的名的方法) $("[name = '"+this.name()+"']").val())
            alert($("[name = '"+this.name()+"']").val());
            if(regex.test($("[name = '"+this.name()+"']").val())){
                //通过校验
                this.submit();
            }else{
                //未通过
               alert('the format error') //错误提示框，文件格式不正确，必须以.xls或.xlsx结尾
            }
        }
    });



</script>